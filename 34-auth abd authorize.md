
ุฏุฑ Kubernetesุ ูุฑุขูุฏ **Authentication (ุงุญุฑุงุฒ ููุช)** ู **Authorization (ูุฌูุฒุฏู)** ุจุฑุง ฺฉูุชุฑู ุฏุณุชุฑุณ ุจู ููุงุจุน ฺฉูุณุชุฑ ุงูุฌุงู ูโุดูุฏ. ุงู ุฏู ูุฑุญูู ููุด ุงุณุงุณ ุฏุฑ ุงููุช ฺฉูุณุชุฑ ุฏุงุฑูุฏ. ุฏุฑ ุงุฏุงูู ูุฑ ฺฉุฏุงู ุฑุง ุชูุถุญ ูโุฏูู:

---

### 1. **Authentication (ุงุญุฑุงุฒ ููุช)**

ุงู ูุฑุญูู ูุดุฎุต ูโฺฉูุฏ ฺฉู "ุดูุง ฺู ฺฉุณ ูุณุชุฏุ" ุง "ฺฉูุงูุช ฺฉู ุฏุฑุฎูุงุณุช ูโุฏูุฏ ฺู ฺฉุณ ุงุณุชุ".

Kubernetes ุงุฒ ฺูุฏู ุฑูุด ุจุฑุง ุงุญุฑุงุฒ ููุช ูพุดุชุจุงู ูโฺฉูุฏ:

#### ุงูู) **TLS Certificates (ฺฏูุงู TLS):**
   - ุฏุฑ ุฒูุงู ุงุฌุงุฏ ฺฉ ฺฉูุงูุชุ ฺฉ ฺฏูุงู TLS ฺฉู ุชูุณุท ฺฉูุณุชุฑ ูุงุจู ุงุนุชูุงุฏ ุงุณุช ุตุงุฏุฑ ูโุดูุฏ.
   - ฺฉูุงูุช ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ฺฏูุงู ุจู ุณุฑูุฑ Kubernetes (API Server) ูุชุตู ูโุดูุฏ.

#### ุจ) **Token-based Authentication (ุชูฺฉู):**
   - ุจุฑุง ฺฉุงุฑุจุฑุงู ู ุณุฑูุณโูุงุ Kubernetes ุงุฒ **ุชูฺฉูโูุง** (ูุซู ServiceAccount Token) ุงุณุชูุงุฏู ูโฺฉูุฏ.
   - ุงู ุชูฺฉูโูุง ุฏุฑ ูุฏุฑ ุฏุฑุฎูุงุณุชโูุง ุงุฑุณุงู ูโุดููุฏ.
   - ูุซุงู:
     ```
     Authorization: Bearer <TOKEN>
     ```

#### ุฌ) **Basic Authentication (ฺฉุงุฑุจุฑ ู ฺฉููู ุนุจูุฑ):**
   - ูุงู `basic-auth.csv` ุฑู API Server ุฐุฎุฑู ูโุดูุฏ ฺฉู ุดุงูู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู ุงุณุช.
   - ุงู ุฑูุด ฺฉูุชุฑ ุชูุตู ูโุดูุฏ ู ูุนูููุงู ุจุฑุง ุชูุณุนู ุง ุชุณุช ุงุณุชูุงุฏู ูโุดูุฏ.

#### ุฏ) **OpenID Connect (OIDC):**
   - Kubernetes ูโุชูุงูุฏ ุงุฒ ุณุณุชูโูุง ุงุญุฑุงุฒ ููุช ุฎุงุฑุฌ ูุซู Google, Okta, ุง Keycloak ูพุดุชุจุงู ฺฉูุฏ.
   - OIDC ฺฉ ุฑูุด ุงูู ุจุฑุง ุงุญุฑุงุฒ ููุช ฺฉุงุฑุจุฑุงู ุณุงุฒูุงู ุงุณุช.

#### ูู) **Webhook Token Authentication:**
   - ุจุฑุง ุงุนุชุจุงุฑุณูุฌ ุชูฺฉูโูุง ุณูุงุฑุด ุงุฒ ฺฉ ูุจโุณุฑูุฑ ุฎุงุฑุฌ ุงุณุชูุงุฏู ูโุดูุฏ.

#### ู) **Static Token Files (ุชูฺฉูโูุง ุงุณุชุงุชฺฉ):**
   - ูุงูโูุง ุงุณุชุงุชฺฉ ฺฉู ุดุงูู ูุณุช ุงุฒ ุชูฺฉูโูุง ู ฺฉุงุฑุจุฑุงู ูุณุชูุฏ.

---

### 2. **Authorization (ูุฌูุฒุฏู)**

ุจุนุฏ ุงุฒ ุงุญุฑุงุฒ ููุชุ Kubernetes ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ฺฉุงุฑุจุฑ ุงุฌุงุฒู ุงูุฌุงู ุนููุงุช ุฏุฑุฎูุงุณุช ุฑุง ุฏุงุฑุฏ ุง ุฎุฑ. ุงู ูุฑุญูู ูุดุฎุต ูโฺฉูุฏ ฺฉู "ุดูุง ฺู ฺฉุงุฑ ูโุชูุงูุฏ ุงูุฌุงู ุฏูุฏุ".

Kubernetes ุงุฒ ฺูุฏู ุฑูุด ุจุฑุง ูุฌูุฒุฏู ูพุดุชุจุงู ูโฺฉูุฏ:

#### ุงูู) **Role-Based Access Control (RBAC):**
   - ฺฉ ุณุณุชู ูุจุชู ุจุฑ ููุด ุจุฑุง ฺฉูุชุฑู ุฏุณุชุฑุณ ุจู ููุงุจุน.
   - **Role:** ุณุทุญ ุฏุณุชุฑุณ ุฏุฑ ฺฉ **namespace** ุฎุงุต.
   - **ClusterRole:** ุณุทุญ ุฏุณุชุฑุณ ุฏุฑ ฺฉู ฺฉูุณุชุฑ.
   - **RoleBinding:** ุงุฎุชุตุงุต ฺฉ Role ุจู ฺฉ ฺฉุงุฑุจุฑ ุง ฺฏุฑูู ุฏุฑ ฺฉ namespace.
   - **ClusterRoleBinding:** ุงุฎุชุตุงุต ฺฉ ClusterRole ุจู ฺฉ ฺฉุงุฑุจุฑ ุง ฺฏุฑูู ุฏุฑ ฺฉู ฺฉูุณุชุฑ.

   **ูุซุงู Role:**
   ```yaml
   apiVersion: rbac.authorization.k8s.io/v1
   kind: Role
   metadata:
     namespace: default
     name: pod-reader
   rules:
   - apiGroups: [""]
     resources: ["pods"]
     verbs: ["get", "list", "watch"]
   ```

#### ุจ) **Node Authorization:**
   - ุจุฑุง ฺฉูุชุฑู ุฏุณุชุฑุณ ููุฏูุง ุจู ููุงุจุน API Server.

#### ุฌ) **Webhook Authorization:**
   - ุฏุฑุฎูุงุณุชโูุง ุจู ฺฉ ูุจโุณุฑูุฑ ุฎุงุฑุฌ ุงุฑุณุงู ูโุดููุฏ ุชุง ูุฌูุฒุฏู ุจุฑุฑุณ ุดูุฏ.

---

### ูุฑุขูุฏ ฺฉู:
1. **Client** (ฺฉุงุฑุจุฑ ุง ุจุฑูุงูู) ุฏุฑุฎูุงุณุช ุฎูุฏ ุฑุง ุจู API Server ูโูุฑุณุชุฏ.
2. **API Server** ุงุจุชุฏุง ฺฉุงุฑุจุฑ ุฑุง **ุงุญุฑุงุฒ ููุช** ูโฺฉูุฏ.
3. ุณูพุณ ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู ุขุง ุงู ฺฉุงุฑุจุฑ ุงุฌุงุฒู ุงูุฌุงู ุนููุงุช ุฏุฑุฎูุงุณุช ุฑุง ุฏุงุฑุฏ (**ูุฌูุฒุฏู**).
4. ุฏุฑ ุตูุฑุช ููููุชโุขูุฒ ุจูุฏู ูุฑ ุฏู ูุฑุญููุ ุฏุฑุฎูุงุณุช ุงุฌุฑุง ูโุดูุฏ.

---

### ุงุจุฒุงุฑูุง ูุฑุชุจุท:
- ุจุฑุง ูุดุงูุฏู ูุงฺฏโูุง ุงุญุฑุงุฒ ููุช ู ูุฌูุฒุฏู:
  ```bash
  kubectl logs -n kube-system <kube-apiserver-pod>
  ```

- ุจุฑุง ุชุณุช ุฏุฑุฎูุงุณุชโูุง:
  ```bash
  kubectl auth can-i <verb> <resource> --as=<user>
  ```



๐ ฺู ฺฉุงุฑูุง ูโุชูู ูุญุฏูุฏ ุง ุงุฌุงุฒู ุจุฏุ
ุจุง verbsูุง ูุซู:

get, list, watch (ููุท ุฎููุฏู)

create, update, patch, delete (ููุดุชู)

ู ููุงุจุน ูุซู:

pods, services, deployments, configmaps, ู...



ุขุฑู ๐ ููุธูุฑุช **`kubectl auth can-i` ฺู ู ฺู ุงุฌุงุฒูโุง ุฑู ูุดูู ูโุฏูุ**
ุจุฐุงุฑ ุชูุฒ ู ฺฉุงุฑุจุฑุฏ ุจฺฏู.

---

## `kubectl auth can-i` ุนู ฺุ

ุงู ุฏุณุชูุฑ ูโูพุฑุณู:

> โ **ุขุง ุงู ูุฒุฑ / ุณุฑูุณโุงฺฉุงูุช ุงุฌุงุฒู ุงูุฌุงู ุงู ฺฉุงุฑ ุฑู ุฏุงุฑู ุง ููุ**

ุฎุฑูุฌ ููุท ฺฉ ุงุฒ ุงู ุฏู ุชุงุณุช:

* โ `yes`
* โ `no`

---

## ุณุงุฎุชุงุฑ ฺฉู ุฏุณุชูุฑ

```bash
kubectl auth can-i <verb> <resource>
```

### ูุซุงู ุณุงุฏู

```bash
kubectl auth can-i get pods
```

ุนู:

> ุขุง ูู ุงุฌุงุฒู ุฏุงุฑู **pod**โูุง ุฑู **get** ฺฉููุ

---

## ูุซุงูโูุง ูพุฑฺฉุงุฑุจุฑุฏ ๐

### 1๏ธโฃ ุฏุฏู ูพุงุฏูุง

```bash
kubectl auth can-i list pods
```

### 2๏ธโฃ ุญุฐู ูพุงุฏ

```bash
kubectl auth can-i delete pods
```

### 3๏ธโฃ ุณุงุฎุช Deployment

```bash
kubectl auth can-i create deployments
```

---

## ุจุฑุฑุณ ุฏุณุชุฑุณ ุฏุฑ namespace ุฎุงุต

```bash
kubectl auth can-i get pods -n monitoring
```

---

## ุจุฑุฑุณ ุฏุณุชุฑุณ ฺฉ ูุฒุฑ ุฎุงุต

```bash
kubectl auth can-i get pods --as=ali
```

ุง ุจุฑุง ServiceAccount:

```bash
kubectl auth can-i get pods \
--as=system:serviceaccount:default:my-sa
```

---

## ุฏุฏู ููู ุฏุณุชุฑุณโูุง (ุฎู ููู ๐ฅ)

```bash
kubectl auth can-i --list
```

ุง ุจุฑุง namespace ุฎุงุต:

```bash
kubectl auth can-i --list -n kube-system
```

---

## ุงู ุฏุณุชูุฑ ุจู ฺ ูุงุจุณุชู ุงุณุชุ

`kubectl auth can-i` ูุชุฌู ุฑู ุจุฑ ุงุณุงุณ ุงูุง ูโุฏู:

* **Role**
* **ClusterRole**
* **RoleBinding**
* **ClusterRoleBinding**

ุนู ุฏููุงู ูููู RBAC ฺฉู ุชุนุฑู ฺฉุฑุฏ.

---

## ฺฉุงุฑุจุฑุฏ ูุงูุน ุชู ฺฉุงุฑ ุฑูุฒูุฑู

โ ุชุณุช RBAC ุจุฏูู ุขุฒููู ู ุฎุทุง
โ ุฏุจุงฺฏ ุฎุทุง:

```
Forbidden: User "X" cannot ...
```

โ ุจุฑุฑุณ ุฏุณุชุฑุณ ServiceAccount ูุจู ุงุฒ Deploy

---

## ุฌูุนโุจูุฏ ุฎู ุฎูุงุตู

> `kubectl auth can-i` = ุชุณุช ุณุฑุน ุงูฺฉู **ุงุฌุงุฒู ุฏุงุฑู ุง ูู**

ุงฺฏู ุฎูุงุณุช:

* ุฎุฑูุฌ `--list` ุฑู ุจุฑุงุช ุชุญูู ฺฉูู
* ุง ู Role ุจููุณู ู ุจุง `can-i` ุชุณุชุด ฺฉูู
* ุง ุฎุทุง Forbidden ูุงูุนโุชู ุญู ฺฉูู

ุจฺฏู ๐

