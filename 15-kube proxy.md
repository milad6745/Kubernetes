# kube proxy

این کامپوننت در کنار kubelete بالا میاد و وظیفه connectivity بین پاد به پاد و پاد به نود و ... را بر عهده دارد .

kube-proxy یکی از اجزای اصلی در معماری Kubernetes است و مسئول مدیریت ترافیک شبکه بین کانتینرها و نودها در یک کلاستر Kubernetes می‌باشد. وظیفه اصلی kube-proxy برقراری سرویس‌ها و مدیریت قوانین شبکه است تا ارتباط بین کانتینرها و دسترسی به سرویس‌ها را فراهم سازد.

عمده وظایف kube-proxy عبارتند از:

**برقراری خدمات (Services):** kube-proxy مسئول برقراری سرویس‌ها در کلاستر است. سرویس‌ها در Kubernetes یک منبع مستقل هستند که به یک مجموعه از پادها متصل می‌شوند و امکان دسترسی به آنها از بیرون کلاستر فراهم می‌کنند. kube-proxy این ارتباطات را برقرار می‌کند.

**لایه L4 Load Balancing:** kube-proxy برای سرویس‌ها لایه‌ی ۴ (لایه Transport) Load Balancer فراهم می‌کند. این به این معناست که بر اساس IP و پورت‌ها (TCP یا UDP) بار ترافیک بین پادها توزیع می‌شود.

**نقشه‌برداری (Endpoint Mapping):** kube-proxy نقشه‌برداری بین سرویس‌ها و پادهایی که آن سرویس را پیاده‌سازی می‌کنند، انجام می‌دهد. در واقع، مدیریت این نقشه بر اساس تغییرات در ReplicaSets یا Podها انجام می‌شود.

4. **Proxy Modeها:** kube-proxy به صورت پیش‌فرض در چندین حالت (Proxy Mode) عمل می‌کند، از جمله iptables، ipvs، و userspace. هر یک از این حالت‌ها باعث مدیریت ترافیک شبکه و ایجاد لایه Load Balancing می‌شوند.

**نقشه‌برداری بازگشتی (Reverse Mapping):** kube-proxy به کمک تغییرات در ReplicaSets و Podها نقشه‌برداری را به‌روزرسانی کرده و درخواست‌های ترافیک شبکه را به پادهای جدید منتقل می‌کند.

کلیدی برای درک بهتر kube-proxy این است که این اجزا از شبکه در Kubernetes باعث ایجاد یک لایهٔ شبکه مجازی می‌شوند که ارتباطات میان کانتینرها و خدمات را مدیریت می‌کند و برای توزیع ترافیک به صورت Load Balancer و همچنین امکان دسترسی به سرویس‌ها از خارج کلاستر کمک می‌کند.
