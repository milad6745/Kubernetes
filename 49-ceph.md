# create cluster with minimum 2 worker

ูููุฏู! ุงฺฏุฑ ูุตุฏ ุฏุงุฑ ฺฉู ุงุฒ **Rook-Ceph** ุจุฑุง ูุตุจ Ceph ุฏุฑ ฺฉูุงุณุชุฑ Kubernetes ุฎูุฏ ุงุณุชูุงุฏู ฺฉูุ ุงู ุจูโุฎุตูุต ุฏุฑ ุงุณุชูุงุฏู ุงุฒ **`kind`** ููุงุณุจ ุงุณุช. **Rook** ฺฉ **Operator** ุงุณุช ฺฉู ุจูโุทูุฑ ุฎุงุต ุจุฑุง ูุฏุฑุช ฺฉูุงุณุชุฑูุง ุฐุฎุฑูโุณุงุฒ ุฏุฑ Kubernetes ุทุฑุงุญ ุดุฏู ู ุจู ุฑุงุญุช ูโุชูุงูุฏ Ceph ุฑุง ุฏุฑ ฺฉูุงุณุชุฑ ูุตุจุ ูพฺฉุฑุจูุฏ ู ูุฏุฑุช ฺฉูุฏ.

### ูุฑุงุญู ูุตุจ **Rook-Ceph** ุจุฑ ุฑู ฺฉูุงุณุชุฑ **kind**:

1. **ุณุงุฎุช ฺฉูุงุณุชุฑ Kubernetes ุจุง ุงุณุชูุงุฏู ุงุฒ `kind`**:
   ุงฺฏุฑ ูููุฒ ฺฉูุงุณุชุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ `kind` ูุณุงุฎุชุ ูโุชูู ุงุฒ ฺฉุงููฺฏ ุฒุฑ ุจุฑุง ุฏุงุดุชู ฺฉ ฺฉูุงุณุชุฑ ุจุง 1 ููุฏ `control-plane` ู 2 ููุฏ `worker` ุงุณุชูุงุฏู ฺฉู (ฺฉู ุจุฑุง ุชุณุช ู ุชูุณุนู ููุงุณุจ ุงุณุช):

   ```yaml
   kind: Cluster
   apiVersion: kind.x-k8s.io/v1alpha4
   nodes:
     - role: control-plane
     - role: worker
     - role: worker
   ```

   ุณูพุณ ฺฉูุงุณุชุฑ ุฑู ุจุณุงุฒ:

   ```bash
   kind create cluster --config kind-config.yaml
   ```

2. **ูุตุจ Rook-Ceph**:
   ุจุฑุง ูุตุจ **Rook-Ceph** ุฏุฑ ฺฉูุงุณุชุฑ Kubernetesุ ุจุงุฏ ุงุจุชุฏุง **Rook Operator** ู ููุงุจุน ููุฑุฏ ูุงุฒ ุขู ุฑุง ูุตุจ ฺฉู. ุงู ฺฉุงุฑ ุจุง ุงุฌุฑุง ุฏุณุชูุฑุงุช ฺฉู ุฏุฑ ุงูุฌุง ุขูุฑุฏู ุดุฏู ุงูุฌุงู ูโุดูุฏ.

   ุงุจุชุฏุง **namespace** ูุฑุจูุท ุจู `rook-ceph` ุฑู ุจุณุงุฒ:

   ```bash
   kubectl create namespace rook-ceph
   ```

3. **ูุตุจ Rook-Ceph Operator**:
   ุญุงูุง ุจุงุฏ **Rook Operator** ุฑู ูุตุจ ฺฉู. ุจุฑุง ูุตุจ ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุณุชูุงุฏู ฺฉู:

   ```bash
   kubectl apply -f https://github.com/rook/rook/releases/download/v1.9.9/rook-ceph-operator.yaml
   ```

   ุงู ุฏุณุชูุฑ Rook Operator ุฑุง ูุตุจ ูโฺฉูุฏ ฺฉู ุจูโุทูุฑ ุฎูุฏฺฉุงุฑ Ceph ุฑุง ุฑู ฺฉูุงุณุชุฑ Kubernetes ูุฏุฑุช ูโฺฉูุฏ.

4. **ุงุฌุงุฏ Ceph Cluster ุจุง ุงุณุชูุงุฏู ุงุฒ Rook**:
   ุญุงูุง ฺฉู Rook-Ceph ูุตุจ ุดุฏุ ุจุงุฏ ฺฉ ูุงู YAML ุจุฑุง ุงุฌุงุฏ ฺฉูุงุณุชุฑ Ceph ุชุนุฑู ฺฉู. ุฏุฑ ุงู ูุงู ูุดุฎุต ูโฺฉู ฺฉู Ceph ุฏุฑ ฺฉูุงุณุชุฑ Kubernetes ฺุทูุฑ ูุตุจ ู ูพฺฉุฑุจูุฏ ุจุดู.

   ุจุฑุง ุงู ฺฉุงุฑุ ฺฉ ูุงู YAML ุจู ูุงู `ceph-cluster.yaml` ุจุณุงุฒ ฺฉู ุจู ุดฺฉู ุฒุฑ ุงุณุช:

   ```yaml
   apiVersion: ceph.rook.io/v1
   kind: CephCluster
   metadata:
     name: ceph
     namespace: rook-ceph
   spec:
     cephVersion:
       image: ceph/ceph:v15
     dataDirHostPath: /var/lib/rook
     mon:
       count: 3
       allowMultiplePerNode: false
     storage:
       useAllNodes: true
       useAllDevices: true
     network:
       hostNetwork: false
   ```

   ุงู ูุงู ฺฉ ฺฉูุงุณุชุฑ Ceph ุจุง ณ ูุงูุชุฑ (`mon`) ุงุฌุงุฏ ูโฺฉูุฏ ู ุจู ุชูุงู ููุฏูุง ู ุฏุณุชฺฏุงูโูุง ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุงุฏูโูุง ุฏุณุชุฑุณ ูโุฏูุฏ.

5. **ุงุนูุงู ฺฉุงููฺฏ ู ุงุฌุงุฏ Ceph Cluster**:
   ุญุงูุง ูุงู YAML ุจุฑุง ุงุฌุงุฏ Ceph Cluster ุฑู ุงุนูุงู ฺฉู:

   ```bash
   kubectl apply -f ceph-cluster.yaml
   ```

   ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ฺฉู ฺฉูุงุณุชุฑ Ceph ุฏุฑ ุฏุงุฎู ฺฉูุงุณุชุฑ Kubernetes ุดูุง ุฑุงูโุงูุฏุงุฒ ุจุดู.

6. **ุจุฑุฑุณ ูุถุนุช ูพุงุฏูุง Ceph**:
   ุจุนุฏ ุงุฒ ุงุนูุงู ฺฉุงููฺฏุ ูโุชูุงู ูุถุนุช ูพุงุฏูุง ูุฑุจูุท ุจู Ceph ุฑุง ุจุฑุฑุณ ฺฉู:

   ```bash
   kubectl -n rook-ceph get pod
   ```

   ุจุง ุงู ุฏุณุชูุฑุ ูโุชูุงู ูุถุนุช ูุตุจ ู ุงุฌุฑุง ูพุงุฏูุง ูุฑุจูุท ุจู Ceph ุฑุง ูุดุงูุฏู ฺฉู. ูุทูุฆู ุดู ฺฉู ุชูุงู ูพุงุฏูุง ุฏุฑ ุญุงู ุงุฌุฑุง ูุณุชูุฏ.

7. **ุงุณุชูุงุฏู ุงุฒ Ceph ุจุฑุง ุฐุฎุฑูโุณุงุฒ (Optional)**:
   ุญุงูุง ฺฉู Ceph ุฑุงูโุงูุฏุงุฒ ุดุฏุ ูโุชูุงู ุงุฒ ุขู ุจูโุนููุงู ฺฉ ุฐุฎุฑูโุณุงุฒ ุจุฑุง Kubernetes ุงุณุชูุงุฏู ฺฉู. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ฺฉ **Persistent Volume (PV)** ู **Persistent Volume Claim (PVC)** ุงุฒ Ceph ุงุฌุงุฏ ฺฉู.

   ุจุฑุง ูุซุงูุ ฺฉ PVC ูโุชูุงูุฏ ุจู ุดฺฉู ุฒุฑ ุจุงุดุฏ:

   ```yaml
   apiVersion: v1
   kind: PersistentVolumeClaim
   metadata:
     name: ceph-pvc
   spec:
     accessModes:
       - ReadWriteOnce
     resources:
       requests:
         storage: 5Gi
     storageClassName: rook-ceph-block
   ```

   ุงู ูุงู PVC ุฑุง ุงุฒ Ceph ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ูโุชูุงู ุงุฒ ุขู ุฏุฑ ูพุงุฏูุง ุฎูุฏ ุงุณุชูุงุฏู ฺฉู.

### ุฎูุงุตู ูุฑุงุญู ูุตุจ Rook-Ceph:

1. ุณุงุฎุช ฺฉูุงุณุชุฑ Kubernetes ุจุง ุงุณุชูุงุฏู ุงุฒ `kind`.
2. ูุตุจ Rook-Ceph Operator.
3. ุงุฌุงุฏ Ceph Cluster ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงู YAML.
4. ุจุฑุฑุณ ูุถุนุช ูพุงุฏูุง ู ฺฉูุงุณุชุฑ Ceph.
5. (ุงุฎุชุงุฑ) ุงุณุชูุงุฏู ุงุฒ Ceph ุจุฑุง ุฐุฎุฑูโุณุงุฒ ุฏุฑ Kubernetes.

### ุงฺฏุฑ ุณูุงู ุฏุงุฑ:
ุงฺฏุฑ ุฏุฑ ูุฑ ูุฑุญูู ูุดฺฉู ุฏุงุดุช ุง ุณูุงู ูพุด ุขูุฏุ ุญุชูุงู ุจฺฏู ุชุง ุจุดุชุฑ ุฑุงูููุง ฺฉูู! ๐
